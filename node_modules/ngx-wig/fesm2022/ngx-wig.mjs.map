{"version":3,"file":"ngx-wig.mjs","sources":["../../../projects/ngx-wig/src/lib/config.ts","../../../projects/ngx-wig/src/lib/ngx-wig-toolbar.service.ts","../../../projects/ngx-wig/src/lib/ngx-wig.component.ts","../../../projects/ngx-wig/src/lib/ngx-wig-component.html","../../../projects/ngx-wig/src/lib/ngx-wig.module.ts","../../../projects/ngx-wig/src/public_api.ts","../../../projects/ngx-wig/src/ngx-wig.ts"],"sourcesContent":["import { InjectionToken } from '@angular/core';\nimport { NgxWigComponent } from './ngx-wig.component';\n\nexport type CommandFunction = (ctx: NgxWigComponent) => void;\n\nexport interface TButton {\n  label?: string;\n  icon?: string;\n  title?: string;\n  children?: TButton[];\n  command?: string | CommandFunction;\n  styleClass?: string;\n  visibleDropdown?: boolean;\n  isOpenOnMouseOver?: boolean;\n}\n\nexport interface TButtonLibrary {\n  [name: string]: TButton;\n}\n\nexport const DEFAULT_LIBRARY_BUTTONS: TButtonLibrary = {\n  list1: {\n    label: 'UL',\n    title: 'Unordered List',\n    command: 'insertunorderedlist',\n    styleClass: 'nw-list-ul',\n    icon: 'nwe-icon-list-ul'\n  },\n  list2: {\n    label: 'OL',\n    title: 'Ordered List',\n    command: 'insertorderedlist',\n    styleClass: 'nw-list-ol',\n    icon: 'nwe-icon-list-ol'\n  },\n  bold: {\n    label: 'B',\n    title: 'Bold',\n    command: 'bold',\n    styleClass: 'nw-bold',\n    icon: 'nwe-icon-bold'\n  },\n  italic: {\n    label: 'I',\n    title: 'Italic',\n    command: 'italic',\n    styleClass: 'nw-italic',\n    icon: 'nwe-icon-italic'\n  },\n  link: {\n    label: 'Link',\n    title: 'Link',\n    command: 'createlink',\n    styleClass: 'nw-link',\n    icon: 'nwe-icon-link'\n  },\n  underline: {\n    label: 'U',\n    title: 'Underline',\n    command: 'underline',\n    styleClass: 'nw-format-underlined',\n    icon: 'nwe-icon-underline'\n  }\n};\n\nexport const CUSTOM_LIBRARY_BUTTONS: TButtonLibrary = {\n  edithtml: {\n    label: 'Edit HTML',\n    title: 'Edit HTML',\n    command: (ctx: NgxWigComponent) => {\n      ctx.editMode = !ctx.editMode;\n    },\n    styleClass: 'nw-button--source',\n    icon: '',\n  }\n};\n\n\nexport const BUTTONS = new InjectionToken<TButton[][]>('BUTTONS');\n","import { Injectable, Inject } from '@angular/core';\nimport { TButtonLibrary, TButton, BUTTONS } from './config';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class NgxWigToolbarService {\n  private _defaultButtonsList: string[] = [];\n  private _buttonLibrary: TButtonLibrary;\n\n  constructor(@Inject(BUTTONS) buttonLibraryConfig: TButtonLibrary[]) {\n    this._buttonLibrary = buttonLibraryConfig.reduce((acc: TButtonLibrary, val: TButtonLibrary) => ({ ...acc, ...val }), {});\n    this._defaultButtonsList = Object.keys(this._buttonLibrary);\n  }\n\n  public setButtons(buttons: string[]): void {\n    if (!Array.isArray(buttons)) {\n      throw new Error('Argument \"buttons\" should be an array');\n    }\n\n    this._defaultButtonsList = buttons;\n  }\n\n  public addStandardButton(\n    name: string,\n    title: string,\n    command: string,\n    styleClass: string,\n    icon: string\n  ) {\n    if (!name || !title || !command) {\n      throw new Error('Arguments \"name\", \"title\" and \"command\" are required');\n    }\n\n    styleClass = styleClass || '';\n    this._buttonLibrary[name] = { title, command, styleClass, icon };\n    this._defaultButtonsList.push(name);\n  }\n\n  public getToolbarButtons(buttonsList?: string): TButton[] {\n    let buttons = this._defaultButtonsList;\n    const toolbarButtons: TButton[] = [];\n\n    if (typeof buttonsList !== 'undefined') {\n      buttons = string2array(buttonsList);\n    }\n\n    buttons.forEach(buttonKey => {\n      if (!buttonKey) {\n        return;\n      }\n\n      if (!this._buttonLibrary[buttonKey]) {\n        throw new Error(\n          `There is no \"${buttonKey}\" in your library. Possible variants: ${Object.keys(this._buttonLibrary)}`\n        );\n      }\n\n      const button = Object.assign({}, this._buttonLibrary[buttonKey]);\n      // button.isActive = () => {return !!this.command && document.queryCommandState(this.command);}\n      toolbarButtons.push(button);\n    });\n\n    return toolbarButtons;\n  }\n}\n\nconst string2array = (keysString: string) =>\n  keysString\n    .split(',')\n    .map(Function.prototype.call, String.prototype.trim);\n","import {\n  Component,\n  ElementRef,\n  EventEmitter,\n  Input,\n  OnChanges,\n  OnInit,\n  Output,\n  SimpleChanges,\n  ViewChild,\n  ViewEncapsulation,\n  forwardRef,\n  Inject,\n  OnDestroy,\n} from '@angular/core';\n\nimport { NG_VALUE_ACCESSOR, ControlValueAccessor } from '@angular/forms';\nimport { NgxWigToolbarService } from './ngx-wig-toolbar.service';\nimport { DOCUMENT } from '@angular/common';\nimport { TButton, CommandFunction } from './config';\n\n/** @dynamic */\n@Component({\n  selector: 'ngx-wig',\n  templateUrl: './ngx-wig-component.html',\n  styleUrls: ['./ngx-wig-component.css'],\n  providers: [\n    NgxWigToolbarService,\n    {\n      provide: NG_VALUE_ACCESSOR,\n      useExisting: forwardRef(() => NgxWigComponent),\n      multi: true,\n    },\n  ],\n  encapsulation: ViewEncapsulation.None,\n})\nexport class NgxWigComponent\n  implements OnInit, OnChanges, OnDestroy, ControlValueAccessor {\n  @Input()\n  public content: string;\n\n  @Input()\n  public placeholder: string;\n\n  @Input()\n  public buttons: string;\n\n  @Input()\n  public disabled: boolean;\n\n  @Output()\n  public contentChange = new EventEmitter();\n\n  @ViewChild('ngWigEditable', { read: ElementRef, static: true })\n  public ngxWigEditable: ElementRef;\n\n  public editMode = false;\n  public container: HTMLElement;\n  public toolbarButtons: TButton[] = [];\n  public hasFocus = false;\n\n  private _mutationObserver: MutationObserver;\n\n  public constructor(\n    private _ngWigToolbarService: NgxWigToolbarService,\n    @Inject(DOCUMENT) private document: any, // cannot set Document here - Angular issue - https://github.com/angular/angular/issues/20351\n    @Inject('WINDOW') private window\n  ) {}\n\n  public execCommand(\n    command: string | CommandFunction,\n    options?: string\n  ): boolean {\n    if (typeof command === 'function') {\n      command(this);\n      return true;\n    }\n\n    if (this.editMode) {\n      return false;\n    }\n\n    if (\n      this.document.queryCommandSupported &&\n      !this.document.queryCommandSupported(command)\n    ) {\n      throw new Error(`The command \"${command}\" is not supported`);\n    }\n    if (command === 'createlink' || command === 'insertImage') {\n      options = window.prompt('Please enter the URL', 'http://') || '';\n      if (!options) {\n        return false;\n      }\n    }\n\n    this.container.focus();\n\n    // use insertHtml for `createlink` command to account for IE/Edge purposes, in case there is no selection\n    const selection = this.document.getSelection().toString();\n\n    if (command === 'createlink' && selection === '') {\n      this.document.execCommand(\n        'insertHtml',\n        false,\n        '<a href=\"' + options + '\">' + options + '</a>'\n      );\n    } else {\n      this.document.execCommand(command, false, options);\n    }\n\n    this.onContentChange(this.container.innerHTML);\n    return true;\n  }\n\n  public ngOnInit(): void {\n    this.toolbarButtons = this._ngWigToolbarService.getToolbarButtons(\n      this.buttons\n    );\n    this.container = this.ngxWigEditable.nativeElement;\n\n    if (this.content) {\n      this.container.innerHTML = this.content;\n    }\n  }\n\n  public ngOnDestroy(): void {\n    if (this._mutationObserver) {\n      this._mutationObserver.disconnect();\n    }\n  }\n\n  public onContentChange(newContent: string): void {\n    this.content = this.isInnerTextEmpty(newContent) ? '' : newContent;\n\n    this.contentChange.emit(this.content);\n    this.propagateChange(this.content);\n  }\n\n  public ngOnChanges(changes: SimpleChanges): void {\n    if (this.container && changes['content']) {\n      // we need to focus the container before pasting at the caret\n      this.container.focus();\n\n      // clear the previous content\n      this.container.innerHTML = '';\n\n      // add the new content\n      this.pasteHtmlAtCaret(changes['content'].currentValue);\n    }\n  }\n\n  public onTextareaChange(newContent: string): void {\n    // model -> view\n    this.container.innerHTML = newContent;\n    this.onContentChange(newContent);\n  }\n\n  public writeValue(value: any): void {\n    if (!value) {\n      value = '';\n    }\n\n    this.container.innerHTML = value;\n    this.content = value;\n  }\n\n  public shouldShowPlaceholder(): boolean {\n    return !!this.placeholder && !this.container.innerText;\n  }\n\n  public registerOnChange(fn: any): void {\n    this.propagateChange = fn;\n  }\n\n  public registerOnTouched(fn: () => void): void {\n    this.propagateTouched = fn;\n  }\n\n  public propagateTouched = () => {};\n\n  public onBlur() {\n    this.hasFocus = false;\n    this.propagateTouched();\n  }\n\n  public setDisabledState(isDisabled: boolean): void {\n    this.disabled = isDisabled;\n  }\n\n  public isInnerTextEmpty(content: string): boolean {\n    const parser = new DOMParser();\n    const htmlDoc = parser.parseFromString(content, 'text/html');\n\n    return htmlDoc.documentElement?.innerText === '';\n  }\n\n  private pasteHtmlAtCaret(html) {\n    let sel;\n    let range;\n\n    if (window.getSelection) {\n      sel = window.getSelection();\n      if (sel.getRangeAt && sel.rangeCount) {\n        range = sel.getRangeAt(0);\n        range.deleteContents();\n\n        // append the content in a temporary div\n        const el = this.document.createElement('div');\n        el.innerHTML = html;\n\n        const frag = this.document.createDocumentFragment();\n        let node;\n        let lastNode;\n\n        while ((node = el.firstChild)) {\n          lastNode = frag.appendChild(node);\n        }\n        range.insertNode(frag);\n\n        // Preserve the selection\n        if (lastNode) {\n          range = range.cloneRange();\n          range.setStartAfter(lastNode);\n          range.collapse(true);\n          sel.removeAllRanges();\n          sel.addRange(range);\n        }\n      }\n    }\n  }\n\n  private propagateChange: any = (_: any) => {};\n}\n","<div class=\"ng-wig\">\n    <ul class=\"nw-toolbar\">\n      <li *ngFor=\"let button of toolbarButtons\"\n          class=\"nw-toolbar__item\">\n        <div *ngIf=\"!button?.children ; else selectMenu\">\n          <button type=\"button\"\n                  class=\"nw-button\"\n                  [ngClass]=\"[button.styleClass]\"\n                  [title]=\"button.title\"\n                  (click)=\"execCommand(button.command)\"\n                  [disabled]=\"disabled\"\n                  tabindex=\"-1\">\n            <ng-container *ngIf=\"!button.icon\">{{ button.label }}</ng-container>\n            <div *ngIf=\"button.icon\"\n                 class=\"nwe-icon\"\n                 [ngClass]=\"[button.icon]\">\n            </div>\n          </button>\n        </div>\n        <ng-template #selectMenu>\n          <div class=\"nwe-dropdown\"\n                (mouseenter)=\"button.isOpenOnMouseOver?button.visibleDropdown = true:true\"\n                (mouseleave)=\"button.isOpenOnMouseOver?button.visibleDropdown = false:true\"\n                (click)=\"!button.isOpenOnMouseOver?button.visibleDropdown = !button.visibleDropdown:true\">\n            <button type=\"button\"\n                  class=\"nw-button\"\n                  [ngClass]=\"[button.styleClass]\"\n                  [title]=\"button.title\"\n                  [disabled]=\"disabled\"\n                  tabindex=\"-1\">\n              <ng-container *ngIf=\"!button.icon\">{{ button.label }}</ng-container>\n              <div *ngIf=\"button.icon\"\n                    class=\"nwe-icon\"\n                    [ngClass]=\"[button.icon]\">\n              </div>\n            </button>\n            <div class=\"nwe-dropdown-content\"\n                  [ngClass]=\"button.visibleDropdown ? 'nwe-show' : ''\">\n              <a *ngFor=\"let child of button.children\"\n                    href=\"#\">\n                <button type=\"button\"\n                      class=\"nw-button\"\n                      [ngClass]=\"[child.styleClass]\"\n                      [title]=\"child.title\"\n                      (click)=\"execCommand(child.command)\"\n                      [disabled]=\"disabled\"\n                      tabindex=\"-1\">\n                  <ng-container *ngIf=\"!child.icon\">{{ child.label }}</ng-container>\n                  <div *ngIf=\"child.icon\"\n                        class=\"nwe-icon\"\n                        [ngClass]=\"[child.icon]\">\n                  </div>\n                </button>\n              </a>\n            </div>\n          </div>\n        </ng-template>\n      </li>\n    </ul>\n\n    <div class=\"nw-editor-container\"\n         (click)=\"container.focus()\"\n         [ngClass]=\"{ 'nw-editor-container--with-toolbar': toolbarButtons.length }\">\n      <div *ngIf=\"editMode\"\n           class=\"nw-editor__src-container\">\n        <textarea [ngModel]=\"content\"\n                  (ngModelChange)=\"onTextareaChange($event)\"\n                  (blur)=\"propagateTouched()\"\n                  class=\"nw-editor__src\">\n        </textarea>\n      </div>\n      <div class=\"nw-editor\"\n           [ngClass]=\"{ 'nw-disabled': disabled,'nw-invisible': editMode }\">\n        <div *ngIf=\"shouldShowPlaceholder()\"\n             class=\"nw-editor__placeholder\"\n             [innerText]=\"placeholder\">\n        </div>\n        <div #ngWigEditable\n             class=\"nw-editor__res\"\n             [attr.contenteditable]=\"!disabled\"\n             [ngClass]=\"{ disabled: disabled}\"\n             (focus)=\"hasFocus = true\"\n             (blur)=\"onBlur()\"\n             (input)=\"onContentChange(ngWigEditable.innerHTML)\"><!--\n    --></div>\n      </div>\n    </div>\n  </div>\n","import { CommonModule } from '@angular/common';\nimport { NgModule, ModuleWithProviders } from '@angular/core';\nimport { NgxWigComponent } from './ngx-wig.component';\nimport { FormsModule } from '@angular/forms';\nimport { TButtonLibrary, DEFAULT_LIBRARY_BUTTONS, BUTTONS, CUSTOM_LIBRARY_BUTTONS } from './config';\n\n\nexport const getWindowObject = (): Window => window;\n\n@NgModule({\n  declarations: [\n    NgxWigComponent\n  ],\n  imports: [\n    CommonModule,\n    FormsModule,\n  ],\n  exports: [NgxWigComponent],\n  providers: [\n    { provide: BUTTONS, multi: true, useValue: DEFAULT_LIBRARY_BUTTONS },\n    { provide: 'WINDOW', useFactory: getWindowObject },\n  ]\n})\nexport class NgxWigModule {\n\n  static forRoot(config?: { buttonsConfig: TButtonLibrary } ): ModuleWithProviders<NgxWigModule> {\n    return {\n      ngModule: NgxWigModule,\n      providers: [\n        {\n          provide: BUTTONS,\n          multi: true, useValue: ((!config || !config?.buttonsConfig) ? DEFAULT_LIBRARY_BUTTONS : config?.buttonsConfig)\n        },\n        { provide: 'WINDOW', useFactory: getWindowObject },\n      ],\n    };\n  }\n\n  static forChild(): ModuleWithProviders<NgxWigModule> {\n    return {ngModule: NgxWigModule };\n  }\n}\n","/*\n * Public API Surface of ngx-wig\n */\n\nexport * from './lib/ngx-wig-toolbar.service';\nexport * from './lib/ngx-wig.component';\nexport * from './lib/ngx-wig.module';\nexport * from './lib/config';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":["i1.NgxWigToolbarService"],"mappings":"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"}